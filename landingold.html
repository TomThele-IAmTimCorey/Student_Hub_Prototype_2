<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Hub Landing 5.3</title>
  
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    header, footer { background-color: #222; color: white; padding: 15px; text-align: center; }
    .container { padding: 20px; }
    h2 { margin-top: 40px; }
    .badges img { height: 100px; margin-right: 10px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { padding: 8px; border: 1px solid #ddd; text-align: left; }
    button { padding: 6px 12px; }
    .bento-wrapper {
      background: #39bad8;
      border-radius: 24px;
      padding: 32px 16px;
      margin-top: 32px;
      margin-bottom: 32px;
      box-shadow: 0 4px 16px rgba(57,186,216,0.10);
    }
    .bento-box {
      background: #f8f8f8;
      border-radius: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.07);
      padding: 24px;
      margin-top: 16px;
      margin-bottom: 32px;
    }
    .bento-row {
      display: flex;
      gap: 24px;
      margin-bottom: 32px;
    }
    .bento-box-2-3 {
      flex: 2 1 0;
      min-width: 0;
      display: flex;
      flex-direction: column;
      justify-content: stretch;
    }
    .bento-box-1-3 {
      flex: 1 1 0;
      min-width: 0;
      display: flex;
      flex-direction: column;
      justify-content: stretch;
    }
    .video-thumbs {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: flex-start;
      align-items: flex-start;
    }
    .video-thumb {
      text-align: center;
      width: 200px;
    }
    .video-thumb img {
      width: 100%;
      border-radius: 10px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.10);
      margin-bottom: 8px;
    }
    /* Scrollable table for courses */
    .scrollable-table {
      max-height: 400px;
      overflow-y: auto;
      margin-top: 10px;
    }
    @media (max-width: 900px) {
      .bento-row { flex-direction: column; }
      .bento-box-2-3, .bento-box-1-3 { width: 100%; }
    }
    @media (max-width: 700px) {
      .video-thumbs { flex-direction: column; align-items: stretch; }
      .video-thumb { width: 100%; }
    }
            body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        .post {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        .post h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        .post .meta {
            font-size: 0.9em;
            color: #888;
            margin-bottom: 20px;
        }
        .post .content {
            line-height: 1.6;
        }
  </style>
</head>
<body>
  <header>
    <h1>Student Hub</h1>
    <p>Navigation Bar (replicate as needed)</p>
  </header>

  <div class="container">
    <h2 id="welcomeText">Welcome In</h2>

    <div class="bento-wrapper">


      <!-- Section 1: Badges -->
      <div class="bento-box">
        <h2>My Badges (Static)</h2>
        <div class="badges">
          <a href="https://bcert.me/sjvhrtrsj"><img src="https://bcert.me/bc/html/img/badges/generated/badge-67772.png" alt="Badge 1"></a>
          <a href="https://bcert.me/ssvlggkvd"><img src="https://bcert.me/bc/html/img/badges/generated/badge-67775.png" alt="Badge 2"></a>
        </div>
        <br>
        <br>
        <button class="btn btn-success" onclick="window.open('https://badgecert.com/login','_blank')">
          Login to BadgeCert
        </button>
        <span>Log into your profile to share your badges on social media!</span>
        <br><br>
        <a href="badge.html">
          <button style="padding:10px 20px; font-size:16px; border-radius:6px; cursor:pointer; color: darkcyan;">
          View My Badges (LIVE)
          </button>
        </a>
      </div>


      <!-- Section 2: Courses -->
      <div class="bento-box">
        <h2>My Courses (Live Data)</h2>
        <div class="scrollable-table">
          <div id="coursesContainer"></div>
        </div>
        <div>
          <h4>Scroll to see more courses</h4>
          <h4>Note: You will periodically be asked to re-validate your course enrollment access</h4>
        </div>
      </div>


      <!-- Section 2.5: FastSpring redirect -->
      <div class="bento-box">
        <h2>My Purchases (Static)</h2>
        <h3>MVP</h3>
        <div class="purchases">
          <Button class="btn btn-success" onclick="window.open('https://iamtimcorey.onfastspring.com/account','_blank')">See Purchases</Button>
          <br>
          <span>Click the button and follow the prompts. Be sure you use the email address that you used when purchasing the course. 
            FastSpring will then email you a link to access your information in their system.</span>
            <br>
            <br>
            -------------------------------------------------
            <h3>With FS integration</h3>
          <button class="btn btn-success" onclick="window.open('https://iamtimcorey.onfastspring.com/account/_Y6p7m16QjuecUpGMlGNuw/U3QByUFwS3E','_blank')">
          See Purchases or Manage Subscription</button>
          <br>
          <span>Log into your profile to share your badges on social media!</span>
        </div>
      </div>


      <!-- Section 3 & 4: Side by side -->
      <div class="bento-row"> 

      <!-- Box 3: Tim's newest video (2/3 width) -->
        <div class="bento-box bento-box-2-3">
          <h2>Tim's newest video (Static)</h2>
          <div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:12px;">
            <iframe src="https://www.youtube.com/embed/sTDcUwfzCsA?si=vNbu85GmQ4pO5E4Z"
                    title="Tim's newest video"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    style="position:absolute;top:0;left:0;width:100%;height:100%;border-radius:12px;">
            </iframe>
          </div>
          <div>>
          <br>
          <a href="YouTube.html">
            <button style="padding:10px 20px; font-size:16px; border-radius:6px; cursor:pointer; color: darkcyan;">
              View Most recent Video (LIVE)
            </button></a>
          </div>
          <span>Live Pull requires our YT API key</span>
        </div>
      

        <!-- Box 4: More videos (1/3 width) -->
        <div class="bento-box bento-box-1-3">
          <h2>More Videos (Static)</h2>
          <div class="video-thumbs">
            <div class="video-thumb">
              <a href="https://youtu.be/fgqm46iR8VI?si=z4iuI1wODohlt4UH" target="_blank">
                <img src="https://img.youtube.com/vi/fgqm46iR8VI/hqdefault.jpg" alt="Video 1 Thumbnail">
                <div>How to Learn C# (2024)</div>
              </a>
            </div>
            <div class="video-thumb">
              <a href="https://youtu.be/3Hl3k87UvpY?si=ligoUItAEb2re7Hn" target="_blank">
                <img src="https://img.youtube.com/vi/3Hl3k87UvpY/hqdefault.jpg" alt="Video 2 Thumbnail">
                <div>How to Learn SQL (2024)</div>
              </a>
            </div>
            <div class="video-thumb">
              <a href="https://youtu.be/ZJTbHEP3smU?si=_ezBSKKEJvFymr1i" target="_blank">
                <img src="https://img.youtube.com/vi/ZJTbHEP3smU/hqdefault.jpg" alt="Video 3 Thumbnail">
                <div>How to Learn .NET MAUI (2024)</div>
              </a>
            </div>
          </div>
        </div>
        </div>
      <!-- End bento-row -->
       

      <!-- BONUS Section: Support -->
      <div class="bento-box">
        <h2>Support for Hub accounts MVP (Live Data))</h2>
          <iframe src="https://support.iamtimcorey.com" width="100%" height="320" frameborder="0"></iframe>
          </div>
      </div>


    <!-- Section 4.5: Podcasts -->
      <div class="bento-box">    
        <h1>Latest Podcast Episode MVP (Live Data)</h1>
        <div id="latest-episode">
          Loading latest episode...
        </div>
      </div>
  
    

      <!-- Section 5: Podcast -->
      <div class="bento-box">
        <h2>Tim's recent Blog post MVP (Live Data))</h2>
          <div id="post-container">
            <p>Loading latest post...</p>
          </div>
      </div>
    </div> 
  </div>

// BadgeCert API integration
//----------------------
<script>
    const rssFeedUrl = 'https://feeds.buzzsprout.com/1183862.rss'; // Replace with the actual RSS feed URL

    async function fetchLatestEpisode() {
      try {
        const response = await fetch(rssFeedUrl);
        const text = await response.text();
        const parser = new DOMParser();
        const xml = parser.parseFromString(text, 'application/xml');

        // Get the first <item> (latest episode)
        const latestEpisode = xml.querySelector('item');
        const title = latestEpisode.querySelector('title').textContent;
        const description = latestEpisode.querySelector('description').textContent;
        const audioUrl = latestEpisode.querySelector('enclosure').getAttribute('url');

        // Display the episode
        document.getElementById('latest-episode').innerHTML = `
          <h2>${title}</h2>
          <p>${description}</p>
          <audio controls>
            <source src="${audioUrl}" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        `;
      } catch (error) {
        console.error('Error fetching the RSS feed:', error);
        document.getElementById('latest-episode').textContent = 'Failed to load the latest episode.';
      }
    }

    fetchLatestEpisode();
  </script>

  // Teachable API integration
  //----------------------
  <script>
document.addEventListener("DOMContentLoaded", () => {
  document.getElementById('welcomeText').textContent =
    "Welcome In, " + (localStorage.getItem('login_name') || "Student");

  const loginEmail = localStorage.getItem('login_email') || "tom.thele@gmail.com";
  const apiKey = "hoUy238I3tditABq22vkjWxEUoylKigb";

  async function loadCourses() {
    const container = document.getElementById('coursesContainer');

    console.log(`Starting API call for ${loginEmail}`);

    try {
      // Step 1: Get studentId by email
      const userResponse = await fetch(
        `https://developers.teachable.com/v1/users?email=${encodeURIComponent(loginEmail)}`,
        {
          method: "GET",
          headers: {
            "accept": "application/json",
            "apikey": apiKey
          }
        }
      );

      if (!userResponse.ok) {
        throw new Error("User lookup failed: " + userResponse.status);
      }

      const userData = await userResponse.json();
      if (!userData.users || userData.users.length === 0) {
        throw new Error("No user found for email " + loginEmail);
      }

      
      const studentId = userData.users[0].id;
      console.log("Found StudentId:", studentId);

      // Step 2: Get user details
      try {
        const response = await fetch(`https://developers.teachable.com/v1/users/${studentId}`, {
          method: "GET",
          headers: {
            "accept": "application/json",
            "apikey": apiKey
          }
        });

        if (!response.ok) {
          throw new Error("API request failed: " + response.status);
        }

        const data = await response.json();
        console.log("User detail data:", data);

        const courses = (data.courses || []).filter(c => c.is_active_enrollment);

        if (!courses.length) {
          container.innerHTML = `
            No enrollments found for ${loginEmail}. 
            Consider getting this Free Course!
            <a href="https://www.iamtimcorey.com/courses/hands-on-refactoring/" target="_blank">
              Hands on Refactoring
            </a>`;
          return;
      }

        // Sort courses by progress
        courses.sort((a, b) => b.percent_complete - a.percent_complete);

        // Build table
        let tableHtml = `<table>
          <tr><th>Course Name</th><th>Progress</th><th>Action</th></tr>`;
        courses.slice(0, 30).forEach(c => {
          let btnLabel = "Not Started";
          if (c.percent_complete === 100) btnLabel = "Review";
          else if (c.percent_complete > 0) btnLabel = "In Progress";

          tableHtml += `<tr>
            <td>${c.course_name}</td>
            <td>${c.percent_complete}%</td>
            <td><a href="https://courses.iamtimcorey.com/courses/enrolled/${c.course_id}" target="_blank">
              <button>${btnLabel}</button>            
            </a></td>
          </tr>`;
          //  <td><a href="https://sso.teachable.com/secure/288799/identity/login/password?redirect_to=https://courses.iamtimcorey.com/courses/enrolled/${c.course_id}" target="_blank">
          //    <button>${btnLabel}</button>
        });
        tableHtml += "</table>";

        if (courses.length > 10) {
          tableHtml += `<div style="margin-top:8px;color:#555;"></div>`;
        }

        container.innerHTML = tableHtml;
      } catch (err) {
        console.error(err);
        container.innerHTML = `Error loading courses for ${loginEmail}`;
      }
    } catch (error) {
      console.error("An error occurred:", error);
      container.innerHTML = `Error looking up user: ${error.message}`;
    }
  }

  // âœ… Call it here (outside the function)
  loadCourses();
});
</script>

// Blog API integration
//----------------------  

    <script>
        async function fetchLatestPost() {
            try {
                const response = await fetch('https://public-api.wordpress.com/rest/v1.1/sites/blog.iamtimcorey.com/posts/');
                const data = await response.json();
                const post = data.posts[0];

                if (post) {
                    const postHtml = `
                        <div class="post">
                            <h1>${post.title}</h1>
                            <div class="meta">
                                <span>Published on ${new Date(post.date).toLocaleDateString()}</span>
                            </div>
                            <div class="content">
                                ${post.content}
                            </div>
                        </div>
                    `;
                    document.getElementById('post-container').innerHTML = postHtml;
                } else {
                    document.getElementById('post-container').innerHTML = '<p>No posts found.</p>';
                }
            } catch (error) {
                console.error('Error fetching the latest post:', error);
                document.getElementById('post-container').innerHTML = '<p>Error loading the latest post.</p>';
            }
        }

        fetchLatestPost();
    </script>  
    
 <a href="https://docs.google.com/spreadsheets/d/1dOszaD17-L6E1McEu3rZSFHJw-epJB7g0Pyl3xLyT9E/edit?usp=sharing" target="_blank">
    Visit Tom GSheet proof of concept </a>
</body>
</html>